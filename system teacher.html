<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="th"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;QuestClassAIverse™ - Math Adventure&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>@import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&amp;display=swap');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Kanit', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.gradient-bg {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.math-gradient {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.mission-gradient-1 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.mission-gradient-2 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.mission-gradient-3 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #a8caba 0%, #5d4e75 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.card-hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.card-hover:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-5px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 20px 40px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.progress-bar {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(90deg, #10b981 0%, #3b82f6 50%, #f59e0b 100%);</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 4px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: width 0.5s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.exp-coin {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(45deg, #ffd700, #ffed4e);</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-background-clip: text;</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-text-fill-color: transparent;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-clip: text;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.badge-glow {</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>animation: glow 2s ease-in-out infinite alternate;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>@keyframes glow {</p>
<p class="p1"><span class="Apple-converted-space">            </span>from { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>to { box-shadow: 0 0 30px rgba(255, 215, 0, 0.8); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.mission-locked {</p>
<p class="p1"><span class="Apple-converted-space">            </span>filter: grayscale(100%);</p>
<p class="p1"><span class="Apple-converted-space">            </span>opacity: 0.5;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.mission-unlocked {</p>
<p class="p1"><span class="Apple-converted-space">            </span>filter: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>opacity: 1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.mission-completed {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 3px solid #10b981;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.avatar-male {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.avatar-female {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.avatar-teacher {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #22d3ee 0%, #0ea5e9 100%);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.leaderboard-gold { background: linear-gradient(135deg, #ffd700, #ffed4e); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.leaderboard-silver { background: linear-gradient(135deg, #c0c0c0, #e8e8e8); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.leaderboard-bronze { background: linear-gradient(135deg, #cd7f32, #daa520); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.quiz-option {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.quiz-option:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f3f4f6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateX(5px);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.quiz-option.selected {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #ddd6fe;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #8b5cf6;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.character-option.selected {</p>
<p class="p1"><span class="Apple-converted-space">             </span>border-color: #4f46e5;</p>
<p class="p1"><span class="Apple-converted-space">             </span>box-shadow: 0 0 20px rgba(79, 70, 229, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.quiz-option.correct {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #dcfce7;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #16a34a;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.quiz-option.incorrect {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #fee2e2;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #dc2626;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.modal {</p>
<p class="p1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(10px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(0, 0, 0, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.notification {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: fixed;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>right: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 1000;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 500;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateX(400px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: transform 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.notification.show {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateX(0);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.notification.success { background: #10b981; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.notification.error { background: #ef4444; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.notification.info { background: #3b82f6; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.notification.warning { background: #f59e0b; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="bg-gray-50 min-h-screen"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Login Screen --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 w-full max-w-md"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-6xl mb-4"&gt;🧮&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h1 class="text-3xl font-bold text-gray-800 mb-2"&gt;QuestClassAIverse™&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p class="text-gray-600"&gt;การผจญภัยคณิตศาสตร์&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p class="text-sm text-purple-600 mt-2"&gt;🎯 เลขยกกำลัง Adventure&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;form id="loginForm" class="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-sm font-medium text-gray-700 mb-2"&gt;รหัสผู้ใช้&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="text" id="username" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="รหัสนักเรียน หรือ Teacher" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-sm font-medium text-gray-700 mb-2"&gt;รหัสผ่าน&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="รหัสผ่าน" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button type="submit" class="w-full gradient-bg text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-opacity"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>🚀 เข้าสู่ระบบ</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/form&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div class="mt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button class="w-full bg-gray-200 text-gray-500 py-3 rounded-lg font-semibold cursor-not-allowed" title="ยังไม่เปิดให้บริการ" disabled&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>📝 สมัครสมาชิก (เร็วๆ นี้)</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mt-6 text-center text-sm text-gray-600 space-y-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;&lt;strong&gt;นักเรียน:&lt;/strong&gt; รหัส นร. จริง / รหัสผ่าน &lt;strong&gt;123456&lt;/strong&gt; (หรือ &lt;strong&gt;demo&lt;/strong&gt;/&lt;strong&gt;demo&lt;/strong&gt;)&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;&lt;strong&gt;คุณครู:&lt;/strong&gt; รหัส &lt;strong&gt;Teacher&lt;/strong&gt; / รหัสผ่าน &lt;strong&gt;admin123&lt;/strong&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Character Selection Screen (For Student) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="characterScreen" class="min-h-screen math-gradient hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="min-h-screen flex items-center justify-center p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 w-full max-w-2xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-6xl mb-4"&gt;🎭&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h1 class="text-3xl font-bold text-gray-800 mb-2"&gt;เลือกตัวละครของคุณ&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-gray-600"&gt;เลือกอวตารและใส่ชื่อเล่นที่คุณชื่นชอบ&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid md:grid-cols-2 gap-8 mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="char-male" class="character-option text-center p-6 border-2 border-gray-300 rounded-xl cursor-pointer transition-all hover:border-blue-500 hover:shadow-lg" onclick="selectCharacter('male')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="w-32 h-32 mx-auto mb-4 rounded-full avatar-male flex items-center justify-center text-6xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>👨‍🎓</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold text-gray-800"&gt;นักผจญภัยชาย&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-gray-600 mt-2"&gt;พร้อมสำหรับการผจญภัยคณิตศาสตร์&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="char-female" class="character-option text-center p-6 border-2 border-gray-300 rounded-xl cursor-pointer transition-all hover:border-pink-500 hover:shadow-lg" onclick="selectCharacter('female')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="w-32 h-32 mx-auto mb-4 rounded-full avatar-female flex items-center justify-center text-6xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>👩‍🎓</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold text-gray-800"&gt;นักผจญภัยหญิง&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-gray-600 mt-2"&gt;พร้อมสำหรับการผจญภัยคณิตศาสตร์&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-sm font-medium text-gray-700 mb-2"&gt;ชื่อเล่นของคุณ&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="text" id="nicknameInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="ใส่ชื่อเล่นที่คุณต้องการ" maxlength="20"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button id="confirmCharacter" onclick="confirmCharacterSelection()" class="w-full gradient-bg text-white py-3 rounded-lg font-semibold hover:opacity-90 transition-opacity disabled:opacity-50" disabled&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>✨ เริ่มการผจญภัย</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Student Dashboard --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="studentDashboard" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Header --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="gradient-bg text-white py-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="container mx-auto px-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex items-center justify-between"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="playerAvatar" class="w-12 h-12 rounded-full flex items-center justify-center text-2xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>👨‍🎓</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h1 class="text-xl font-bold" id="playerName"&gt;นักผจญภัย&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-xs opacity-80" id="playerClass"&gt;Demo Class&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div class="text-right"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-xs opacity-80"&gt;Level&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-lg font-bold" id="playerLevel"&gt;1&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="text-right"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-xs opacity-80"&gt;EXP&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-sm font-bold" id="playerExp"&gt;0/100&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="text-right"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-xs opacity-80"&gt;Coins&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-sm font-bold" id="playerCoins"&gt;1000&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button id="resetDemoDataBtn" onclick="resetDemoData()" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg transition-colors text-sm hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>ล้างข้อมูล</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="logout()" class="bg-white/20 hover:bg-white/30 px-3 py-2 rounded-lg transition-colors text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>ออกจากระบบ</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Navigation --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white shadow-sm sticky top-0 z-40"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="container mx-auto px-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex overflow-x-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showStudentSection('dashboardContent')" id="nav-dashboardContent" class="nav-button student-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-purple-500 text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>🏠 หน้าหลัก</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showStudentSection('missions')" id="nav-missions" class="nav-button student-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-transparent text-gray-600 hover:border-purple-300 hover:text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>🎯 ภารกิจ</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showStudentSection('leaderboard')" id="nav-leaderboard" class="nav-button student-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-transparent text-gray-600 hover:border-purple-300 hover:text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>🏆 กระดานคะแนน</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showStudentSection('analysis')" id="nav-analysis" class="nav-button student-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-transparent text-gray-600 hover:border-purple-300 hover:text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>📊 วิเคราะห์ผล</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Main Content --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="container mx-auto px-6 py-8"&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Dashboard Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-dashboardContent" class="student-section-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Profile &amp; Stats Grid --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid lg:grid-cols-3 gap-6 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Profile Card --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white rounded-2xl shadow p-6 card-hover"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="dashboardAvatar" class="w-20 h-20 rounded-full flex items-center justify-center text-4xl flex-shrink-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>👨‍🎓</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h3 class="text-xl font-bold text-gray-800" id="dashboardName"&gt;นักผจญภัย&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-gray-500" id="dashboardClass"&gt;Demo Class&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="mt-2 space-y-1 text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;p&gt;&lt;strong&gt;Level:&lt;/strong&gt; &lt;span id="dashboardLevel"&gt;1&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;p&gt;&lt;strong&gt;EXP:&lt;/strong&gt; &lt;span class="font-semibold text-yellow-500" id="dashboardExp"&gt;0/100&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;p&gt;&lt;strong&gt;Coins:&lt;/strong&gt; &lt;span class="font-semibold text-yellow-500" id="dashboardCoins"&gt;1000&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Badges --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white rounded-2xl shadow p-6 card-hover"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-lg font-bold text-gray-800 mb-3"&gt;🏅 ป้ายความสำเร็จ&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="badgesContainer" class="flex justify-around items-center h-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center opacity-30"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="w-16 h-16 mx-auto bg-gray-200 rounded-full flex items-center justify-center text-3xl mb-1"&gt;🧩&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500"&gt;Maze Master&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center opacity-30"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="w-16 h-16 mx-auto bg-gray-200 rounded-full flex items-center justify-center text-3xl mb-1"&gt;🍄&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500"&gt;Power Collector&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center opacity-30"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="w-16 h-16 mx-auto bg-gray-200 rounded-full flex items-center justify-center text-3xl mb-1"&gt;🌉&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500"&gt;Science Explorer&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Quick Stats --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white rounded-2xl shadow p-6 card-hover"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;h3 class="text-lg font-bold text-gray-800 mb-3"&gt;📈 สถิติด่วน&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div class="space-y-2 text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;ภารกิจที่ผ่าน:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="font-bold text-green-600 text-base" id="completedMissions"&gt;0/3&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;คะแนนรวม:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="font-bold text-blue-600 text-base" id="totalScore"&gt;0&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;div class="flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;เวลาเล่นรวม:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="font-bold text-purple-600 text-base" id="totalPlayTime"&gt;0 นาที&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-gray-600"&gt;ความแม่นยำ:&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="font-bold text-orange-600 text-base" id="accuracy"&gt;0%&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Mission Progress --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white rounded-2xl shadow p-6 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="flex justify-between items-center mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;h3 class="text-xl font-bold text-gray-800"&gt;🎯 ความคืบหน้าภารกิจ&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;button class="bg-yellow-100 text-yellow-700 text-sm font-semibold px-3 py-1 rounded-lg"&gt;ตอบแทนแบบเบิ้มๆ&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="grid md:grid-cols-3 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Mission Cards updated style --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="mission1Card" class="bg-gray-100 rounded-xl p-4 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-4xl mb-2 opacity-50"&gt;🧩&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h4 class="text-lg font-bold text-gray-700"&gt;Maze Quest&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-sm text-gray-500 mb-3"&gt;เขาวงกตแห่งเลขยกกำลัง&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="mission1Btn" class="w-full bg-gray-300 text-gray-600 py-2 rounded-lg font-semibold text-sm cursor-not-allowed" disabled&gt;🔒 ทำ Pre-test ก่อน&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="mission2Card" class="bg-gray-100 rounded-xl p-4 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-4xl mb-2 opacity-50"&gt;🍄&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h4 class="text-lg font-bold text-gray-700"&gt;Power Collector&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-sm text-gray-500 mb-3"&gt;นักสะสมพลังแห่งป่า&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="mission2Btn" class="w-full bg-gray-300 text-gray-600 py-2 rounded-lg font-semibold text-sm cursor-not-allowed" disabled&gt;🔒 ผ่านด่าน 1 ก่อน&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div id="mission3Card" class="bg-gray-100 rounded-xl p-4 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-4xl mb-2 opacity-50"&gt;🌉&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h4 class="text-lg font-bold text-gray-700"&gt;Science Bridge&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-sm text-gray-500 mb-3"&gt;สะพานแห่งวิทยาศาสตร์&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="mission3Btn" class="w-full bg-gray-300 text-gray-600 py-2 rounded-lg font-semibold text-sm cursor-not-allowed" disabled&gt;🔒 ผ่านด่าน 2 ก่อน&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Test Status --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid md:grid-cols-2 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Pre-Test --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="preTestCard" class="bg-white rounded-2xl shadow p-6 card-hover text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="text-5xl mb-3"&gt;📋&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold text-gray-800 mb-2"&gt;แบบทดสอบก่อนเรียน&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="preTestContent"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-600 mb-4"&gt;ทำแบบทดสอบเพื่อประเมินความรู้พื้นฐาน&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button onclick="startTest('pre')" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>🚀 เริ่มทำแบบทดสอบ</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Post-Test --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="postTestCard" class="bg-white rounded-2xl shadow p-6 card-hover text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="text-5xl mb-3 opacity-30"&gt;📊&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold text-gray-800 mb-2"&gt;แบบทดสอบหลังเรียน&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="postTestContent"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-500 mb-4"&gt;ผ่านภารกิจทั้ง 3 ด่านก่อน&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="postTestBtn" onclick="startTest('post')" class="bg-gray-300 text-gray-500 px-6 py-2 rounded-lg font-semibold cursor-not-allowed" disabled&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>🔒 ยังไม่พร้อม</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Missions Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-missions" class="student-section-content hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-3xl font-bold text-gray-800 mb-4"&gt;🎯 ภารกิจการผจญภัย&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-gray-600"&gt;เลือกภารกิจที่คุณต้องการท้าทาย&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid md:grid-cols-3 gap-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Mission 1 Detail --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mission-gradient-1 p-6 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-6xl mb-4"&gt;🧩&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h3 class="text-2xl font-bold text-gray-800"&gt;Maze Quest&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-600 mt-2"&gt;เขาวงกตแห่งเลขยกกำลัง&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="space-y-3 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;นิยามเลขยกกำลัง&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;องค์ประกอบของเลขยกกำลัง&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;การหาค่าเลขยกกำลัง&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="text-sm text-gray-600 mb-2"&gt;เวลาที่กำหนด&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="text-lg font-bold text-blue-600 mb-4" id="mission1TimeLimit"&gt;-- นาที&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="startMission(1)" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-semibold transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>🚀 เริ่มภารกิจ</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;!-- Mission 2 Detail --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mission-gradient-2 p-6 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-6xl mb-4"&gt;🍄&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h3 class="text-2xl font-bold text-gray-800"&gt;Power Collector&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-600 mt-2"&gt;นักสะสมพลังแห่งป่า&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="space-y-3 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;สมบัติการคูณและหาร&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;สมบัติเลขยกกำลังซ้อน&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;สมบัติเลขยกกำลัง 0 และ 1&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="text-sm text-gray-600 mb-2"&gt;เวลาที่กำหนด&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="text-lg font-bold text-blue-600 mb-4" id="mission2TimeLimit"&gt;-- นาที&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="startMission(2)" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-semibold transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>🚀 เริ่มภารกิจ</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;!-- Mission 3 Detail --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mission-gradient-3 p-6 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-6xl mb-4"&gt;🌉&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h3 class="text-2xl font-bold text-white"&gt;Science Bridge&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-200 mt-2"&gt;สะพานแห่งวิทยาศาสตร์&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="space-y-3 mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;การเขียนสัญกรณ์วิทยาศาสตร์&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;การเปรียบเทียบ&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-green-500"&gt;✓&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-sm"&gt;การบวก ลบ คูณ หาร&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="text-sm text-gray-600 mb-2"&gt;เวลาที่กำหนด&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="text-lg font-bold text-blue-600 mb-4" id="mission3TimeLimit"&gt;-- นาที&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="startMission(3)" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-semibold transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>🚀 เริ่มภารกิจ</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Leaderboard Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-leaderboard" class="student-section-content hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-3xl font-bold text-gray-800 mb-4"&gt;🏆 กระดานคะแนน&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-gray-600"&gt;ดูอันดับของผู้เล่นทั้งหมด&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white rounded-2xl shadow-lg p-6 max-w-4xl mx-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="studentLeaderboardContainer" class="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Leaderboard rows will be injected here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Analysis Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-analysis" class="student-section-content hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-3xl font-bold text-gray-800 mb-4"&gt;📊 วิเคราะห์ผลการเรียนรู้&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-gray-600"&gt;ติดตามความก้าวหน้าและจุดที่ต้องพัฒนา&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white rounded-2xl shadow-lg p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="grid md:grid-cols-2 gap-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;h3 class="text-xl font-bold text-gray-800 mb-4"&gt;คะแนน Pre-test vs Post-test&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;canvas id="studentTestScoresChart"&gt;&lt;/canvas&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h3 class="text-xl font-bold text-gray-800 mb-4"&gt;ความแม่นยำตามหัวข้อ&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;canvas id="studentAccuracyByTopicChart"&gt;&lt;/canvas&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Teacher Dashboard --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="teacherDashboard" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;!-- Header --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="gradient-bg text-white py-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="container mx-auto px-6 flex items-center justify-between"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="w-12 h-12 rounded-full flex items-center justify-center text-2xl avatar-teacher"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>👨‍🏫</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h1 class="text-xl font-bold"&gt;แดชบอร์ดคุณครู&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-xs opacity-80"&gt;โรงเรียน MTTMONGKOL&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onclick="logout()" class="bg-white/20 hover:bg-white/30 px-3 py-2 rounded-lg transition-colors text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>ออกจากระบบ</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Navigation --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white shadow-sm sticky top-0 z-40"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="container mx-auto px-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex overflow-x-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showTeacherSection('conclusion')" id="nav-conclusion" class="nav-button teacher-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-purple-500 text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ภาพรวม</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showTeacherSection('analytics')" id="nav-analytics" class="nav-button teacher-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-transparent text-gray-600 hover:border-purple-300 hover:text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ข้อมูลนักเรียน</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showTeacherSection('teacherLeaderboard')" id="nav-teacherLeaderboard" class="nav-button teacher-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-transparent text-gray-600 hover:border-purple-300 hover:text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>กระดานคะแนน</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="showTeacherSection('management')" id="nav-management" class="nav-button teacher-nav px-6 py-4 font-medium whitespace-nowrap border-b-2 border-transparent text-gray-600 hover:border-purple-300 hover:text-purple-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>จัดการชั้นเรียน</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Main Content --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="container mx-auto px-6 py-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Conclusion Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-conclusion" class="teacher-section-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div class="flex justify-between items-center mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-3xl font-bold text-gray-800"&gt;ภาพรวม&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="loadTeacherData()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span&gt;🔄&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span&gt;รีเฟรชข้อมูล&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white p-6 rounded-2xl shadow-lg flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-blue-100 text-blue-600 p-4 rounded-full text-2xl"&gt;👥&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-500"&gt;นักเรียนทั้งหมด&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-2xl font-bold" id="teacherTotalStudents"&gt;0&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white p-6 rounded-2xl shadow-lg flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-green-100 text-green-600 p-4 rounded-full text-2xl"&gt;📈&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-500"&gt;คะแนนเฉลี่ย&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-2xl font-bold" id="teacherAvgScore"&gt;0%&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white p-6 rounded-2xl shadow-lg flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-yellow-100 text-yellow-600 p-4 rounded-full text-2xl"&gt;🎯&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-500"&gt;ภารกิจที่สำเร็จ&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-2xl font-bold" id="teacherMissionCompletion"&gt;0%&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white p-6 rounded-2xl shadow-lg flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-purple-100 text-purple-600 p-4 rounded-full text-2xl"&gt;💡&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-gray-500"&gt;ค่า DS เฉลี่ย&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;p class="text-2xl font-bold" id="teacherAvgDs"&gt;+0.00%&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid grid-cols-1 lg:grid-cols-5 gap-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="lg:col-span-3 bg-white rounded-2xl shadow-lg p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold text-gray-800 mb-4"&gt;ภาพรวมคะแนนนักเรียน&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;canvas id="teacherStudentScoresChart"&gt;&lt;/canvas&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="lg:col-span-2 bg-white rounded-2xl shadow-lg p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold text-gray-800 mb-4"&gt;นักเรียนที่ต้องดูแลเป็นพิเศษ&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;ul id="studentsToHelpList" class="space-y-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;!-- Students needing help will be populated here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Student Analytics Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-analytics" class="teacher-section-content hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white rounded-2xl shadow-lg p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-2xl font-bold"&gt;ข้อมูลนักเรียนทั้งหมด&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center gap-4 w-full md:w-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;input type="text" id="studentSearch" placeholder="ค้นหาชื่อนักเรียน..." class="w-full md:w-64 p-2 border rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg whitespace-nowrap"&gt;Export CSV&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="overflow-x-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;table class="w-full text-left"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;tr class="bg-gray-100"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="p-3"&gt;ชื่อ-สกุล&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="p-3"&gt;ชั้น&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="p-3"&gt;Level&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="p-3"&gt;คะแนน Pre-test&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="p-3"&gt;คะแนน Post-test&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;th class="p-3"&gt;DS&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;tbody id="studentAnalyticsTable"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Student data will be populated here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Teacher Leaderboard Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-teacherLeaderboard" class="teacher-section-content hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div class="bg-white rounded-2xl shadow-lg p-6 max-w-4xl mx-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-2xl font-bold text-center mb-4"&gt;กระดานคะแนนรวม&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="teacherLeaderboardContainer" class="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Leaderboard rows will be injected here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;!-- Classroom Management Section --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="section-management" class="teacher-section-content hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div class="flex justify-between items-center mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-3xl font-bold text-gray-800"&gt;จัดการชั้นเรียน&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="openCreateClassModal()" class="bg-purple-600 hover:bg-purple-700 text-white px-5 py-2 rounded-lg font-semibold flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span&gt;+&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span&gt;สร้างห้องเรียนใหม่&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="classListContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Class cards will be populated here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Modals &amp; Notifications --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="notification-container"&gt;&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Test/Mission Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="quizModal" class="fixed inset-0 z-[100] modal items-center justify-center hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="p-4 border-b flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2 id="quizTitle" class="text-2xl font-bold"&gt;แบบทดสอบ&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div id="quizProgress" class="text-lg font-semibold text-gray-600"&gt;ข้อ 1 / 10&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onclick="closeQuiz()" class="text-gray-500 hover:text-gray-800 text-3xl"&gt;&amp;times;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="quizContent" class="p-8 overflow-y-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Quiz content will be injected here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div id="aiHintContainer" class="p-4 bg-purple-50 border-t hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p class="text-sm text-purple-800 text-center" id="aiHintText"&gt;กำลังขอคำใบ้จาก AI...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div class="p-4 border-t flex justify-end items-center gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button id="aiHintButton" onclick="getAIHint()" class="bg-purple-100 text-purple-700 px-4 py-2 rounded-lg font-semibold hidden"&gt;✨ ขอคำใบ้จาก AI&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button id="nextQuestionBtn" onclick="nextQuestion()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg"&gt;ข้อถัดไป&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Mission Failed Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="missionFailedModal" class="fixed inset-0 z-[100] modal items-center justify-center hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg text-center p-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="text-6xl mb-4"&gt;😭&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2 class="text-2xl font-bold text-red-600 mb-4"&gt;ภารกิจไม่สำเร็จ&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p class="text-gray-600 mb-6" id="failReasonText"&gt;ดูเหมือนว่าเวลาจะหมดลงซะก่อน ลองทบทวนเนื้อหาแล้วกลับมาลองใหม่อีกครั้งนะ!&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="youtubeLinkContainer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;a href="#" target="_blank" class="bg-red-500 hover:bg-red-600 text-white font-semibold px-6 py-3 rounded-lg inline-block"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>📺 ทบทวนบทเรียนที่นี่</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/a&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button onclick="closeMissionFailedModal()" class="mt-4 text-gray-500 hover:text-gray-700"&gt;ปิด&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Create Class Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="createClassModal" class="fixed inset-0 z-[100] modal items-center justify-center hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;form id="createClassForm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="p-6 border-b"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-2xl font-bold text-gray-800"&gt;สร้างห้องเรียนใหม่&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="p-6 space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label class="block text-sm font-medium text-gray-700 mb-1"&gt;ชื่อห้องเรียน&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="newClassName" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="เช่น ม.1/1 ห้องเรียนคณิตศาสตร์" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label class="block text-sm font-medium text-gray-700 mb-1"&gt;รายวิชา&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="newClassSubject" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="เช่น คณิตศาสตร์พื้นฐาน" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label class="block text-sm font-medium text-gray-700 mb-1"&gt;คำอธิบายสั้นๆ&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;textarea id="newClassDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="เกี่ยวกับห้องเรียนนี้..."&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="p-4 bg-gray-50 rounded-b-2xl flex justify-end space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button type="button" onclick="closeCreateClassModal()" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg"&gt;ยกเลิก&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg"&gt;สร้างห้องเรียน&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/form&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Student Detail Modal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="studentDetailModal" class="fixed inset-0 z-[100] modal items-center justify-center hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="p-6 border-b flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2 class="text-2xl font-bold text-gray-800"&gt;ข้อมูลนักเรียน&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onclick="closeStudentDetailModal()" class="text-gray-500 hover:text-gray-800 text-3xl"&gt;&amp;times;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="studentDetailContent" class="p-6 space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Details will be injected here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p&gt;กำลังโหลด...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div class="p-4 bg-gray-50 rounded-b-2xl flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onclick="closeStudentDetailModal()" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg"&gt;ปิด&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Gemini API Configuration ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>const API_KEY = ""; // Leave this as an empty string.</p>
<p class="p1"><span class="Apple-converted-space">        </span>const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Embedded Real Data ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>const DB_MEMBERS = [{"member_id":"0-2","full_name":"demo ","nickname":"demo","email":"demo@example.com","password_hash":"demo","class":"T-STAFF","student_id":"T001","role":"admin"},{"member_id":"1","full_name":"ศศิธร ชาญกิจ","nickname":"เกมส์","email":"m201001@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201001","role":"student"},{"member_id":"2","full_name":"พศิน วรเวช","nickname":"อาร์ต","email":"m201002@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201002","role":"student"},{"member_id":"3","full_name":"ณัฐดนัย กุลนาถ","nickname":"บิ๊กกี้","email":"m201003@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201003","role":"student"},{"member_id":"4","full_name":"ปาณิสรา พงศ์พิพัฒน์","nickname":"ยูกิ","email":"m201004@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201004","role":"student"},{"member_id":"5","full_name":"กมลวรรณ วรากร","nickname":"เกมส์","email":"m201005@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201005","role":"student"},{"member_id":"6","full_name":"ปกรณ์ เทวฤทธิ์","nickname":"กัน","email":"m201006@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201006","role":"student"},{"member_id":"7","full_name":"ณัฐชนิษา วิเศษสิน","nickname":"เกมส์","email":"m201007@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201007","role":"student"},{"member_id":"8","full_name":"ญาดา วัฒนา","nickname":"จูน","email":"m201008@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201008","role":"student"},{"member_id":"9","full_name":"ปุณยาพร ชูเกียรติ","nickname":"วิว","email":"m201009@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201009","role":"student"},{"member_id":"10","full_name":"กฤติน ไชยยศ","nickname":"ยูกิ","email":"m201010@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201010","role":"student"},{"member_id":"11","full_name":"พศิน ศรีสวัสดิ์","nickname":"ไอซ์","email":"m201011@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201011","role":"student"},{"member_id":"12","full_name":"ปุณยาพร เรืองเดช","nickname":"กานต์","email":"m201012@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201012","role":"student"},{"member_id":"13","full_name":"พศิน สิริกุล","nickname":"ป๊อป","email":"m201013@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201013","role":"student"},{"member_id":"14","full_name":"อัญชิสา กุลนาถ","nickname":"ฝน","email":"m201014@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201014","role":"student"},{"member_id":"15","full_name":"สุพิชชา กิตติคุณ","nickname":"แพน","email":"m201015@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201015","role":"student"},{"member_id":"16","full_name":"ณัฐชยา วิเศษสิน","nickname":"คิว","email":"m201016@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201016","role":"student"},{"member_id":"17","full_name":"วชิรวิชญ์ ชาญวุฒิ","nickname":"ริว","email":"m201017@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201017","role":"student"},{"member_id":"18","full_name":"อัครเดช จิรภัทร","nickname":"มายด์","email":"m201018@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201018","role":"student"},{"member_id":"19","full_name":"ขวัญชนก อภิวัฒน์","nickname":"โย","email":"m201019@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201019","role":"student"},{"member_id":"20","full_name":"ชญานิศ เพ็ญศรี","nickname":"เนย","email":"m201020@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201020","role":"student"},{"member_id":"21","full_name":"ปุณณวิช มนตรี","nickname":"ไตตั้น","email":"m201021@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201021","role":"student"},{"member_id":"22","full_name":"จิรัชญา สาระพงษ์","nickname":"ตังค์","email":"m201022@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201022","role":"student"},{"member_id":"23","full_name":"พชร สาระพงษ์","nickname":"ใบเฟิร์น","email":"m201023@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201023","role":"student"},{"member_id":"24","full_name":"สุพิชชา จารุวัฒน์","nickname":"น้ำค้าง","email":"m201024@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201024","role":"student"},{"member_id":"25","full_name":"ศศิธร เพ็ญศรี","nickname":"ไอซ์","email":"m201025@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201025","role":"student"},{"member_id":"26","full_name":"วริศรา วัฒนะชัย","nickname":"แบม","email":"m201026@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201026","role":"student"},{"member_id":"27","full_name":"ศุภิกา นภาพร","nickname":"ผิง","email":"m201027@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201027","role":"student"},{"member_id":"28","full_name":"ฐาปนีย์ ธีรศักดิ์","nickname":"พีค","email":"m201028@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201028","role":"student"},{"member_id":"29","full_name":"เมธาวี ศุภมิตร","nickname":"น้ำหวาน","email":"m201029@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201029","role":"student"},{"member_id":"30","full_name":"พิชญาภา วรเวช","nickname":"ไอซ์","email":"m201030@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201030","role":"student"},{"member_id":"31","full_name":"สุชาดา จิรภัทร","nickname":"ดรีม","email":"m201031@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201031","role":"student"},{"member_id":"32","full_name":"ศศิธร ภัทรพงษ์","nickname":"กันต์","email":"m201032@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201032","role":"student"},{"member_id":"33","full_name":"กฤติน ไพศาลชัย","nickname":"นัท","email":"m201033@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201033","role":"student"},{"member_id":"34","full_name":"ธีรภัทร สาระพงษ์","nickname":"วิน","email":"m201034@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201034","role":"student"},{"member_id":"35","full_name":"ลลิตา จิตรสง่า","nickname":"ดรีม","email":"m201035@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201035","role":"student"},{"member_id":"36","full_name":"ชยุต เทวฤทธิ์","nickname":"ภีม","email":"m201036@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201036","role":"student"},{"member_id":"37","full_name":"ลลิตา เทวฤทธิ์","nickname":"จูน","email":"m201037@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201037","role":"student"},{"member_id":"38","full_name":"อัจจิมา โพธิ์งาม","nickname":"ลิล","email":"m201038@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201038","role":"student"},{"member_id":"39","full_name":"นันท์นภัส สกุลนิล","nickname":"คิว","email":"m201039@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201039","role":"student"},{"member_id":"40","full_name":"ณัฐดนัย วรเวช","nickname":"กันต์","email":"m201040@school.ac.th","password_hash":"123456","class":"ม.2/1","student_id":"M201040","role":"student"},{"member_id":"281","full_name":"ปิยธิดา อัครเดช","nickname":"กันต์","email":"m208001@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208001","role":"student"},{"member_id":"282","full_name":"ชลธร ภัทรพงษ์","nickname":"ดาว","email":"m208002@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208002","role":"student"},{"member_id":"283","full_name":"อาทิตยา อัครเดช","nickname":"ขวัญ","email":"m208003@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208003","role":"student"},{"member_id":"284","full_name":"ธนกฤต พงศ์พิพัฒน์","nickname":"ตังค์","email":"m208004@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208004","role":"student"},{"member_id":"285","full_name":"กฤติน จิตรสง่า","nickname":"มะเหมี่ยว","email":"m208005@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208005","role":"student"},{"member_id":"286","full_name":"ธีรศักดิ์ เจริญสุข","nickname":"จ๊ะจ๋า","email":"m208006@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208006","role":"student"},{"member_id":"287","full_name":"อริศรา ธนวัฒน์กุล","nickname":"ดาว","email":"m208007@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208007","role":"student"},{"member_id":"288","full_name":"ขวัญชนก สวัสดิมงคล","nickname":"มุก","email":"m208008@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208008","role":"student"},{"member_id":"289","full_name":"กมลวรรณ คชสิงห์","nickname":"แนน","email":"m208009@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208009","role":"student"},{"member_id":"290","full_name":"แพรวา สุธี","nickname":"น้ำค้าง","email":"m208010@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208010","role":"student"},{"member_id":"291","full_name":"ศุภกิจ เจริญสุข","nickname":"มอส","email":"m208011@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208011","role":"student"},{"member_id":"292","full_name":"ธันวา ทัศนีย์","nickname":"พิม","email":"m208012@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208012","role":"student"},{"member_id":"293","full_name":"ลลิตา ทัศนีย์","nickname":"ริว","email":"m208013@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208013","role":"student"},{"member_id":"294","full_name":"พิมพ์ลดา นฤเบศ","nickname":"พิม","email":"m208014@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208014","role":"student"},{"member_id":"295","full_name":"ณัฐนนท์ วารุณ","nickname":"เอิร์ธ","email":"m208015@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208015","role":"student"},{"member_id":"296","full_name":"เพชรัตน์ สวัสดิมงคล","nickname":"โม","email":"m208016@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208016","role":"student"},{"member_id":"297","full_name":"ปิยะ กิตติคุณ","nickname":"พิม","email":"m208017@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208017","role":"student"},{"member_id":"298","full_name":"ศิวกรณ์ สาระพงษ์","nickname":"อิง","email":"m208018@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208018","role":"student"},{"member_id":"299","full_name":"สหภูมิ กาญจนทรัพย์","nickname":"โบ๊ท","email":"m208019@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208019","role":"student"},{"member_id":"300","full_name":"พิชญาภา ทีปังกร","nickname":"เอิร์ธ","email":"m208020@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208020","role":"student"},{"member_id":"301","full_name":"วชิรวิชญ์ อินทรา","nickname":"นิว","email":"m208021@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208021","role":"student"},{"member_id":"302","full_name":"ศิวกรณ์ สุธี","nickname":"ลูกน้ำ","email":"m208022@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208022","role":"student"},{"member_id":"303","full_name":"ศศิธร อัครเดช","nickname":"เกล","email":"m208023@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208023","role":"student"},{"member_id":"304","full_name":"ณัฐวุฒิ มงคลพงศ์","nickname":"มิน","email":"m208024@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208024","role":"student"},{"member_id":"305","full_name":"วรัลชญา วารุณ","nickname":"เชอรี่","email":"m208025@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208025","role":"student"},{"member_id":"306","full_name":"อัญชิสา นฤเบศ","nickname":"แบงค์","email":"m208026@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208026","role":"student"},{"member_id":"307","full_name":"ปรเมศวร์ วารุณ","nickname":"มิว","email":"m208027@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208027","role":"student"},{"member_id":"308","full_name":"ชยุต จิตรสง่า","nickname":"ไฟล์ท","email":"m208028@school.ac.th","password_hash":"123456","class":"ม.2/8","student_id":"M208028","role":"student"},{"member_id":"311","full_name":"ธนวัฒน์ กิตติเดช","nickname":"ข้าวปั้น","email":"m209001@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209001","role":"student"},{"member_id":"312","full_name":"พชร วรเวช","nickname":"น้ำตาล","email":"m209002@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209002","role":"student"},{"member_id":"313","full_name":"ญาดา พงษ์ทอง","nickname":"อ้น","email":"m209003@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209003","role":"student"},{"member_id":"314","full_name":"ปวีณา ปิยะธิดา","nickname":"อาร์ต","email":"m209004@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209004","role":"student"},{"member_id":"315","full_name":"ธิดารัตน์ จิรภัทร","nickname":"ขวัญ","email":"m209005@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209005","role":"student"},{"member_id":"316","full_name":"ภัทรพร กาญจนทรัพย์","nickname":"ยูกิ","email":"m209006@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209006","role":"student"},{"member_id":"317","full_name":"กมลวรรณ เจริญสุข","nickname":"ภีม","email":"m209007@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209007","role":"student"},{"member_id":"318","full_name":"ชญานิศ บุญเกิด","nickname":"ยีนส์","email":"m209008@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209008","role":"student"},{"member_id":"319","full_name":"ปิยวัฒน์ วิเศษศรี","nickname":"โย","email":"m209009@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209009","role":"student"},{"member_id":"320","full_name":"ณัฐนนท์ นวลจันทร์","nickname":"จ๊ะจ๋า","email":"m209010@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209010","role":"student"},{"member_id":"321","full_name":"พชร ศิริวัฒน์","nickname":"เจ","email":"m209011@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209011","role":"student"},{"member_id":"322","full_name":"สหภูมิ คชสิงห์","nickname":"พีค","email":"m209012@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209012","role":"student"},{"member_id":"323","full_name":"ชนาธิป ศรีสวัสดิ์","nickname":"เตย","email":"m209013@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209013","role":"student"},{"member_id":"324","full_name":"ศิรินภา ภัทรพงษ์","nickname":"โม","email":"m209014@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209014","role":"student"},{"member_id":"325","full_name":"วรัลชญา อภิวัฒน์","nickname":"วิน","email":"m209015@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209015","role":"student"},{"member_id":"326","full_name":"ธันวา ปัญญา","nickname":"มิน","email":"m209016@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209016","role":"student"},{"member_id":"327","full_name":"ปุณยาพร ชาญวุฒิ","nickname":"พีค","email":"m209017@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209017","role":"student"},{"member_id":"328","full_name":"ฐาปนีย์ สาระพงษ์","nickname":"คิว","email":"m209018@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209018","role":"student"},{"member_id":"329","full_name":"พลอยไพลิน โภคิน","nickname":"จ๊ะจ๋า","email":"m209019@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209019","role":"student"},{"member_id":"330","full_name":"นฤดม เรืองเดช","nickname":"มิว","email":"m209020@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209020","role":"student"},{"member_id":"331","full_name":"ปาณิสรา กิตติวานิช","nickname":"ลิล","email":"m209021@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209021","role":"student"},{"member_id":"332","full_name":"ธนวัฒน์ นภาพร","nickname":"พิงค์","email":"m209022@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209022","role":"student"},{"member_id":"333","full_name":"นภดล บุญเกิด","nickname":"น้ำหวาน","email":"m209023@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209023","role":"student"},{"member_id":"334","full_name":"นันทวุฒิ ฐิติกานต์","nickname":"ภีม","email":"m209024@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209024","role":"student"},{"member_id":"335","full_name":"ปิยะ อินทร์อุดม","nickname":"น้ำตาล","email":"m209025@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209025","role":"student"},{"member_id":"336","full_name":"สุชาดา ภัทรพงษ์","nickname":"ข้าวปั้น","email":"m209026@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209026","role":"student"},{"member_id":"337","full_name":"ปุณยาพร จิตรสง่า","nickname":"ดรีม","email":"m209027@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209027","role":"student"},{"member_id":"338","full_name":"ณัฐชนิษา ชูเกียรติ","nickname":"ซาร่า","email":"m209028@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209028","role":"student"},{"member_id":"339","full_name":"ภัทรพร อรุณรักษ์","nickname":"โม","email":"m209029@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209029","role":"student"},{"member_id":"340","full_name":"วชิรวิชญ์ ศรีสง่า","nickname":"นัท","email":"m209030@school.ac.th","password_hash":"123456","class":"ม.2/9","student_id":"M209030","role":"student"}];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const DB_ATTEMPTS = [{"member_id":1,"mission_id":1,"attempt_no":1,"correct":7,"exp_gained":70,"coin_gained":1000,"badges":"Maze Master","time_total_sec":77,"pass":true},{"member_id":1,"mission_id":2,"attempt_no":1,"correct":6,"exp_gained":60,"coin_gained":0,"badges":"Power Collector","time_total_sec":56,"pass":true},{"member_id":2,"mission_id":1,"attempt_no":1,"correct":9,"exp_gained":90,"coin_gained":1000,"badges":"Maze Master","time_total_sec":112,"pass":true},{"member_id":3,"mission_id":1,"attempt_no":1,"correct":4,"exp_gained":40,"coin_gained":0,"badges":"","time_total_sec":130,"pass":false},{"member_id":3,"mission_id":1,"attempt_no":2,"correct":8,"exp_gained":80,"coin_gained":1000,"badges":"Maze Master","time_total_sec":95,"pass":true},{"member_id":4,"mission_id":1,"attempt_no":1,"correct":10,"exp_gained":100,"coin_gained":1000,"badges":"Maze Master","time_total_sec":65,"pass":true},{"member_id":4,"mission_id":2,"attempt_no":1,"correct":8,"exp_gained":80,"coin_gained":0,"badges":"Power Collector","time_total_sec":88,"pass":true},{"member_id":4,"mission_id":3,"attempt_no":1,"correct":9,"exp_gained":90,"coin_gained":0,"badges":"Science Explorer","time_total_sec":120,"pass":true},{"member_id":5,"mission_id":1,"attempt_no":1,"correct":5,"exp_gained":50,"coin_gained":0,"badges":"","time_total_sec":150,"pass":false}];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const DB_PRE_TESTS = [{"member_id":1,"score":2},{"member_id":2,"score":5},{"member_id":3,"score":4},{"member_id":4,"score":1},{"member_id":5,"score":3},{"member_id":6,"score":6},{"member_id":7,"score":0},{"member_id":8,"score":3},{"member_id":9,"score":5},{"member_id":10,"score":2},{"member_id":11,"score":2},{"member_id":12,"score":3},{"member_id":13,"score":6},{"member_id":14,"score":3},{"member_id":15,"score":3},{"member_id":16,"score":3},{"member_id":17,"score":7},{"member_id":18,"score":7},{"member_id":19,"score":5},{"member_id":20,"score":4},{"member_id":21,"score":5},{"member_id":22,"score":6},{"member_id":23,"score":2},{"member_id":24,"score":5},{"member_id":25,"score":2},{"member_id":26,"score":3},{"member_id":27,"score":5},{"member_id":28,"score":1},{"member_id":29,"score":3},{"member_id":30,"score":2},{"member_id":31,"score":3},{"member_id":32,"score":0},{"member_id":33,"score":1},{"member_id":34,"score":2},{"member_id":35,"score":5},{"member_id":36,"score":3},{"member_id":37,"score":4},{"member_id":38,"score":5},{"member_id":39,"score":2},{"member_id":40,"score":4},{"member_id":280,"score":2},{"member_id":281,"score":2},{"member_id":282,"score":2},{"member_id":283,"score":1},{"member_id":284,"score":3},{"member_id":285,"score":3},{"member_id":286,"score":2},{"member_id":287,"score":1},{"member_id":288,"score":5},{"member_id":289,"score":2},{"member_id":290,"score":4},{"member_id":291,"score":2},{"member_id":292,"score":5},{"member_id":293,"score":5},{"member_id":294,"score":2},{"member_id":295,"score":1},{"member_id":296,"score":5},{"member_id":297,"score":6},{"member_id":298,"score":4},{"member_id":299,"score":4},{"member_id":300,"score":5},{"member_id":301,"score":5},{"member_id":302,"score":2},{"member_id":303,"score":3},{"member_id":304,"score":4},{"member_id":305,"score":3},{"member_id":306,"score":5},{"member_id":307,"score":2},{"member_id":308,"score":5},{"member_id":309,"score":4},{"member_id":310,"score":3},{"member_id":311,"score":5},{"member_id":312,"score":5},{"member_id":313,"score":2},{"member_id":314,"score":4},{"member_id":315,"score":6},{"member_id":316,"score":3},{"member_id":317,"score":3},{"member_id":318,"score":2},{"member_id":319,"score":3},{"member_id":320,"score":5},{"member_id":321,"score":2},{"member_id":322,"score":1},{"member_id":323,"score":3},{"member_id":324,"score":1},{"member_id":325,"score":4},{"member_id":326,"score":3},{"member_id":327,"score":1},{"member_id":328,"score":3},{"member_id":329,"score":3},{"member_id":330,"score":4},{"member_id":331,"score":3},{"member_id":332,"score":6},{"member_id":333,"score":3},{"member_id":334,"score":3},{"member_id":335,"score":3},{"member_id":336,"score":3},{"member_id":337,"score":4},{"member_id":338,"score":4},{"member_id":339,"score":6},{"member_id":340,"score":1}];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const DB_POST_TESTS = [{"member_id":1,"score":8},{"member_id":2,"score":9},{"member_id":3,"score":7},{"member_id":4,"score":8},{"member_id":5,"score":6},{"member_id":6,"score":8},{"member_id":7,"score":7},{"member_id":8,"score":7},{"member_id":9,"score":4},{"member_id":10,"score":7},{"member_id":11,"score":8},{"member_id":12,"score":7},{"member_id":13,"score":7},{"member_id":14,"score":4},{"member_id":15,"score":8},{"member_id":16,"score":8},{"member_id":17,"score":8},{"member_id":18,"score":9},{"member_id":19,"score":8},{"member_id":20,"score":2},{"member_id":21,"score":6},{"member_id":22,"score":8},{"member_id":23,"score":5},{"member_id":24,"score":7},{"member_id":25,"score":6},{"member_id":26,"score":7},{"member_id":27,"score":7},{"member_id":28,"score":8},{"member_id":29,"score":6},{"member_id":30,"score":8},{"member_id":31,"score":9},{"member_id":32,"score":7},{"member_id":33,"score":7},{"member_id":34,"score":7},{"member_id":35,"score":7},{"member_id":36,"score":6},{"member_id":37,"score":8},{"member_id":38,"score":9},{"member_id":39,"score":8},{"member_id":40,"score":8},{"member_id":280,"score":7},{"member_id":281,"score":8},{"member_id":282,"score":6},{"member_id":283,"score":7},{"member_id":284,"score":7},{"member_id":285,"score":8},{"member_id":286,"score":8},{"member_id":287,"score":7},{"member_id":288,"score":9},{"member_id":289,"score":7},{"member_id":290,"score":9},{"member_id":291,"score":6},{"member_id":292,"score":8},{"member_id":293,"score":9},{"member_id":294,"score":8},{"member_id":295,"score":8},{"member_id":296,"score":9},{"member_id":297,"score":7},{"member_id":298,"score":8},{"member_id":299,"score":9},{"member_id":300,"score":7},{"member_id":301,"score":8},{"member_id":302,"score":7},{"member_id":303,"score":7},{"member_id":304,"score":8},{"member_id":305,"score":5},{"member_id":306,"score":7},{"member_id":307,"score":6},{"member_id":308,"score":9},{"member_id":309,"score":9},{"member_id":310,"score":7},{"member_id":311,"score":9},{"member_id":312,"score":8},{"member_id":313,"score":8},{"member_id":314,"score":8},{"member_id":315,"score":7},{"member_id":316,"score":8},{"member_id":317,"score":7},{"member_id":318,"score":1},{"member_id":319,"score":8},{"member_id":320,"score":8},{"member_id":321,"score":9},{"member_id":322,"score":9},{"member_id":323,"score":9},{"member_id":324,"score":7},{"member_id":325,"score":7},{"member_id":326,"score":6},{"member_id":327,"score":8},{"member_id":328,"score":9},{"member_id":329,"score":7},{"member_id":330,"score":8},{"member_id":331,"score":7},{"member_id":332,"score":7},{"member_id":333,"score":6},{"member_id":334,"score":7},{"member_id":335,"score":7},{"member_id":336,"score":7},{"member_id":337,"score":9},{"member_id":338,"score":7},{"member_id":339,"score":7},{"member_id":340,"score":4}];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const DB_QUESTIONS = [</p>
<p class="p1"><span class="Apple-converted-space">             </span>// Mission 1: นิยามและองค์ประกอบ</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'easy', question: "2³ มีค่าเท่าใด?", options: ["6", "8", "9", "12"], correct: 1, explanation: "2³ = 2 × 2 × 2 = 8" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'easy', question: "ในเลขยกกำลัง 5⁴ ฐานคือเลขใด?", options: ["4", "5", "9", "20"], correct: 1, explanation: "ในเลขยกกำลัง ฐาน (base) คือตัวเลขที่อยู่ด้านล่าง ซึ่งคือ 5" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'easy', question: "3² มีค่าเท่าใด?", options: ["6", "9", "12", "15"], correct: 1, explanation: "3² = 3 × 3" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'easy', question: "4¹ มีค่าเท่าใด?", options: ["1", "4", "0", "ไม่มีค่า"], correct: 1, explanation: "เลขใดก็ตามยกกำลัง 1 = ตัวมันเอง" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'medium', question: "(-3)² มีค่าเท่าใด?", options: ["-9", "9", "-6", "6"], correct: 1, explanation: "(-3)² = (-3) × (-3) = 9 (ลบคูณลบได้บวก)" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'medium', question: "ฐานของ 16³ คืออะไร?", options: ["16", "3", "16³", "48"], correct: 0, explanation: "ฐานคือตัวเลขที่ถูกยกกำลัง ซึ่งก็คือ 16" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'medium', question: "ฐานของ -(3)³ คืออะไร?", options: ["-3", "3", "-27", "27"], correct: 0, explanation: "ฐานคือตัวเลขที่อยู่ในวงเล็บ ซึ่งก็คือ -3" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'hard', question: "100⁰ มีค่าเท่าใด?", options: ["0", "1", "100", "10"], correct: 1, explanation: "เลขใดๆ (ยกเว้น 0) ที่ยกกำลัง 0 จะมีค่าเท่ากับ 1 เสมอ" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'hard', question: "(-1)¹⁰⁰ มีค่าเท่าใด?", options: ["-1", "1", "-100", "100"], correct: 1, explanation: "เลขลบยกกำลังคู่จะได้ค่าบวกเสมอ และ 1 ยกกำลังอะไรก็ได้ 1" },</p>
<p class="p1"><span class="Apple-converted-space">             </span>{ mission_id: 1, level: 'hard', question: "ข้อใดคือการเขียน 8 × 8 × 8 ในรูปเลขยกกำลัง?", options: ["3⁸", "8³", "8 × 3", "24"], correct: 1, explanation: "8 คูณกัน 3 ตัว เขียนได้เป็น 8³" }</p>
<p class="p1"><span class="Apple-converted-space">        </span>];</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const MOCK_CLASSES = [</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: 'ม.2/1 คณิตศาสตร์พื้นฐาน', subject: 'คณิตศาสตร์', students: 40 },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: '2/8 ห้องเรียน EIS ', subject: 'คณิตศาสตร์', students: 27 },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: '2/9 ห้องเรียน EIS', subject: 'คณิตศาสตร์', students: 30}</p>
<p class="p1"><span class="Apple-converted-space">        </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>let currentUser = {};</p>
<p class="p1"><span class="Apple-converted-space">        </span>let currentQuiz = {};</p>
<p class="p1"><span class="Apple-converted-space">        </span>let currentGame = {};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Basic UI Control ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function showStudentSection(sectionId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.student-section-content').forEach(s =&gt; s.classList.add('hidden'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById(`section-${sectionId}`).classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.student-nav').forEach(b =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>b.classList.remove('border-purple-500', 'text-purple-600');</p>
<p class="p1"><span class="Apple-converted-space">                </span>b.classList.add('border-transparent', 'text-gray-600');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById(`nav-${sectionId}`).classList.add('border-purple-500', 'text-purple-600');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Specifically for student leaderboard</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (sectionId === 'leaderboard') {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>const studentLeaderboardData = getFullLeaderboardData();</p>
<p class="p1"><span class="Apple-converted-space">                 </span>populateLeaderboard('studentLeaderboardContainer', studentLeaderboardData);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showTeacherSection(sectionId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.teacher-section-content').forEach(s =&gt; s.classList.add('hidden'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById(`section-${sectionId}`).classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.teacher-nav').forEach(b =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>b.classList.remove('border-purple-500', 'text-purple-600');</p>
<p class="p1"><span class="Apple-converted-space">                </span>b.classList.add('border-transparent', 'text-gray-600');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById(`nav-${sectionId}`).classList.add('border-purple-500', 'text-purple-600');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showScreen(screenId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>['loginScreen', 'characterScreen', 'studentDashboard', 'teacherDashboard'].forEach(id =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const el = document.getElementById(id);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if(el) el.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">             </span>const targetScreen = document.getElementById(screenId);</p>
<p class="p1"><span class="Apple-converted-space">             </span>if(targetScreen) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>targetScreen.style.display = (screenId === 'loginScreen' || screenId === 'characterScreen') ? 'flex' : 'block';</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Login &amp; Logout Logic ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('loginForm').addEventListener('submit', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const username = document.getElementById('username').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const password = document.getElementById('password').value;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (username.toLowerCase() === 'teacher' &amp;&amp; password === 'admin123') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>loginAsTeacher();</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (username.toLowerCase() === 'demo' &amp;&amp; password === 'demo') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentUser = { role: 'student', member_id: 'demo', full_name: 'นักเรียนสาธิต', nickname: 'เดโม่', class: 'Demo Class'};</p>
<p class="p1"><span class="Apple-converted-space">                </span>loginAsStudent(currentUser);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const student = DB_MEMBERS.find(m =&gt; m.student_id.toLowerCase() === username.toLowerCase());</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (student &amp;&amp; student.password_hash === password) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>currentUser = student;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>loginAsStudent(currentUser);</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>showNotification('รหัสผู้ใช้หรือรหัสผ่านไม่ถูกต้อง', 'error');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function loginAsStudent(userData) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (userData.member_id === 'demo') {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>showScreen('characterScreen');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>showScreen('studentDashboard');</p>
<p class="p1"><span class="Apple-converted-space">                 </span>loadStudentData(userData.member_id);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function loginAsTeacher() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>showScreen('teacherDashboard');</p>
<p class="p1"><span class="Apple-converted-space">            </span>loadTeacherData();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function logout() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentUser = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentQuiz = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentGame = {};</p>
<p class="p1"><span class="Apple-converted-space">            </span>showScreen('loginScreen');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Character Selection (For Demo User) ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>let selectedAvatar = null;</p>
<p class="p1"><span class="Apple-converted-space">        </span>function selectCharacter(gender) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>selectedAvatar = gender;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.character-option').forEach(el =&gt; el.classList.remove('selected'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById(`char-${gender}`).classList.add('selected');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('confirmCharacter').disabled = !document.getElementById('nicknameInput').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('nicknameInput').addEventListener('input', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('confirmCharacter').disabled = !this.value.trim() || !selectedAvatar;</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function confirmCharacterSelection() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const nickname = document.getElementById('nicknameInput').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!nickname || !selectedAvatar) return;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>currentUser.nickname = nickname;</p>
<p class="p1"><span class="Apple-converted-space">            </span>showScreen('studentDashboard');</p>
<p class="p1"><span class="Apple-converted-space">            </span>loadStudentData('demo'); // Load data after screen is visible</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function resetDemoData() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (currentUser &amp;&amp; currentUser.member_id === 'demo') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Re-initialize the demo user's data to a fresh state</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentUser.data = {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>profile: { name: currentUser.nickname, class: 'Demo Class' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>stats: { level: 1, exp: 0, exp_to_next: 100, coins: 1000, completedMissionsCount: 0, totalPlayTime: 0, accuracy: 0, levelGroup: null },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>progress: { preTest: null, postTest: null, completedMissions: [], badges: [] }</p>
<p class="p1"><span class="Apple-converted-space">                </span>};</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Re-render the UI with the fresh data</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateStudentUI(currentUser.data);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Manually reset the test cards to their initial HTML state</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('preTestContent').innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-gray-600 mb-4"&gt;ทำแบบทดสอบเพื่อประเมินความรู้พื้นฐาน&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="startTest('pre')" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>🚀 เริ่มทำแบบทดสอบ</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('postTestContent').innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-gray-500 mb-4"&gt;ผ่านภารกิจทั้ง 3 ด่านก่อน&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button id="postTestBtn" onclick="startTest('post')" class="bg-gray-300 text-gray-500 px-6 py-2 rounded-lg font-semibold cursor-not-allowed" disabled&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>🔒 ยังไม่พร้อม</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>showNotification('ข้อมูลเดโม่ถูกรีเซ็ตแล้ว', 'success');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Data Loading &amp; Processing ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function getStudentDataById(memberId) {</p>
<p class="p1"><span class="Apple-converted-space">             </span>const userProfile = DB_MEMBERS.find(m =&gt; m.member_id == memberId);</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (!userProfile) return null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>const studentAttempts = DB_ATTEMPTS.filter(a =&gt; a.member_id == memberId);</p>
<p class="p1"><span class="Apple-converted-space">             </span>const preTest = DB_PRE_TESTS.find(p =&gt; p.member_id == memberId) || null;</p>
<p class="p1"><span class="Apple-converted-space">             </span>const postTest = DB_POST_TESTS.find(p =&gt; p.member_id == memberId) || null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>const totalExp = Math.floor(Math.random() * 101) + 200; // Random EXP 200-300</p>
<p class="p1"><span class="Apple-converted-space">             </span>const level = 3;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>const completedMissions = [...new Set(studentAttempts.filter(a =&gt; a.pass).map(a =&gt; a.mission_id))];</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>const denominator = preTest ? 10 - preTest.score : 0;</p>
<p class="p1"><span class="Apple-converted-space">             </span>const ds_value = (preTest &amp;&amp; postTest &amp;&amp; denominator &gt; 0) ? ((postTest.score - preTest.score) / denominator * 100) : 0;</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>return {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>profile: { name: userProfile.full_name, class: userProfile.class },</p>
<p class="p1"><span class="Apple-converted-space">                 </span>stats: { level, exp: totalExp, ds: ds_value },</p>
<p class="p1"><span class="Apple-converted-space">                 </span>progress: { preTest, postTest, completedMissions }</p>
<p class="p1"><span class="Apple-converted-space">             </span>};</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function getFullLeaderboardData() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return DB_MEMBERS</p>
<p class="p1"><span class="Apple-converted-space">                </span>.filter(m =&gt; m.role === 'student')</p>
<p class="p1"><span class="Apple-converted-space">                </span>.map(member =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const preTest = DB_PRE_TESTS.find(p =&gt; p.member_id == member.member_id) || { score: 0 };</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const postTest = DB_POST_TESTS.find(p =&gt; p.member_id == member.member_id) || { score: 0 };</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const totalExp = Math.floor(Math.random() * 101) + 200;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const level = 3;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const denominator = 10 - preTest.score;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const ds_value = denominator &gt; 0 ? ((postTest.score - preTest.score) / denominator * 100) : 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>return {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>name: member.nickname || member.full_name,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>level,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ds_value,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ds: `${ds_value &gt;= 0 ? '+' : ''}${ds_value.toFixed(2)}%`,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>exp: totalExp</p>
<p class="p1"><span class="Apple-converted-space">                    </span>};</p>
<p class="p1"><span class="Apple-converted-space">                </span>})</p>
<p class="p1"><span class="Apple-converted-space">                </span>.sort((a, b) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (b.level !== a.level) return b.level - a.level;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (b.ds_value !== a.ds_value) return b.ds_value - a.ds_value;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return b.exp - a.exp;</p>
<p class="p1"><span class="Apple-converted-space">                </span>})</p>
<p class="p1"><span class="Apple-converted-space">                </span>.map((player, index) =&gt; ({ ...player, rank: index + 1 }));</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function loadStudentData(memberId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>let studentData;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (memberId === 'demo') {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>const preTest = {score: Math.floor(Math.random() * 5) + 1}; // Random pre-test 1-5</p>
<p class="p1"><span class="Apple-converted-space">                 </span>const postTest = {score: Math.floor(Math.random() * 4) + 6}; // Random post-test 6-9</p>
<p class="p1"><span class="Apple-converted-space">                 </span>let levelGroup = 'อ่อน';</p>
<p class="p1"><span class="Apple-converted-space">                 </span>if(preTest) {</p>
<p class="p1"><span class="Apple-converted-space">                     </span>if (preTest.score &gt;= 7) levelGroup = 'เก่ง';</p>
<p class="p1"><span class="Apple-converted-space">                     </span>else if (preTest.score &gt;= 3) levelGroup = 'กลาง';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>studentData = {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>profile: { name: currentUser.nickname, class: 'Demo Class' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>stats: { level: 3, exp: Math.floor(Math.random() * 101) + 200, exp_to_next: 300, coins: 1000, completedMissionsCount: 3, totalPlayTime: 15, accuracy: 85, levelGroup },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>progress: { preTest, postTest, completedMissions: [1,2,3], badges: ['Maze Master', 'Power Collector'] }</p>
<p class="p1"><span class="Apple-converted-space">                </span>};</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const userProfile = DB_MEMBERS.find(m =&gt; m.member_id == memberId);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const studentAttempts = DB_ATTEMPTS.filter(a =&gt; a.member_id == memberId);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const preTest = DB_PRE_TESTS.find(p =&gt; p.member_id == memberId) || null;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const postTest = DB_POST_TESTS.find(p =&gt; p.member_id == memberId) || null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const totalExp = Math.floor(Math.random() * 101) + 200;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const totalCoins = studentAttempts.reduce((sum, a) =&gt; sum + Number(a.coin_gained || 0), 1000);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const level = 3;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const expInLevel = totalExp;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const completedMissions = [...new Set(studentAttempts.filter(a =&gt; a.pass).map(a =&gt; a.mission_id))];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const badges = [...new Set(studentAttempts.flatMap(a =&gt; (a.badges || '').split('|').filter(Boolean)))];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const totalPlayTimeMinutes = Math.round(studentAttempts.reduce((sum, a) =&gt; sum + Number(a.time_total_sec || 0), 0) / 60);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const totalCorrect = studentAttempts.reduce((sum, a) =&gt; sum + Number(a.correct || 0), 0);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const totalQuestions = studentAttempts.length * 10;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const accuracy = totalQuestions &gt; 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>let levelGroup = 'อ่อน';</p>
<p class="p1"><span class="Apple-converted-space">                </span>if(preTest &amp;&amp; preTest.score) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (preTest.score &gt;= 7) levelGroup = 'เก่ง';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>else if (preTest.score &gt;= 3) levelGroup = 'กลาง';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>studentData = {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>profile: { name: userProfile.nickname || userProfile.full_name, class: userProfile.class },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>stats: { level, exp: expInLevel, exp_to_next: 300, coins: totalCoins, completedMissionsCount: completedMissions.length, totalPlayTime: totalPlayTimeMinutes, accuracy, levelGroup },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>progress: { preTest, postTest, completedMissions, badges }</p>
<p class="p1"><span class="Apple-converted-space">                </span>};</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentUser.data = studentData; // Store processed data in current user</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateStudentUI(studentData);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function loadTeacherData() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Create a comprehensive student data array first</p>
<p class="p1"><span class="Apple-converted-space">            </span>const studentData = DB_MEMBERS</p>
<p class="p1"><span class="Apple-converted-space">                </span>.filter(m =&gt; m.role === 'student')</p>
<p class="p1"><span class="Apple-converted-space">                </span>.map(member =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const preTest = DB_PRE_TESTS.find(p =&gt; p.member_id == member.member_id) || { score: 0 };</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const postTest = DB_POST_TESTS.find(p =&gt; p.member_id == member.member_id) || { score: 0 };</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const totalExp = Math.floor(Math.random() * 101) + 200; // Random EXP 200-300</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const level = 3; // Keep level at 3 as per previous request</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const denominator = 10 - preTest.score;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const ds_value = denominator &gt; 0 ? ((postTest.score - preTest.score) / denominator * 100) : 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>return {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>member_id: member.member_id,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>name: member.full_name,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>nickname: member.nickname,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>class: member.class,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>level,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>exp: totalExp,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>pre: preTest.score,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>post: postTest.score,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ds_value,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>ds: `${ds_value &gt;= 0 ? '+' : ''}${ds_value.toFixed(2)}%`</p>
<p class="p1"><span class="Apple-converted-space">                    </span>};</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Now use studentData for analytics</p>
<p class="p1"><span class="Apple-converted-space">            </span>const analytics = studentData;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// And for leaderboard</p>
<p class="p1"><span class="Apple-converted-space">            </span>const leaderboard = [...studentData] // Create a copy for sorting</p>
<p class="p1"><span class="Apple-converted-space">                </span>.sort((a, b) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (b.level !== a.level) return b.level - a.level;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (b.ds_value !== a.ds_value) return b.ds_value - a.ds_value; // Use numeric value</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return b.exp - a.exp;</p>
<p class="p1"><span class="Apple-converted-space">                </span>})</p>
<p class="p1"><span class="Apple-converted-space">                </span>.slice(0, 10)</p>
<p class="p1"><span class="Apple-converted-space">                </span>.map((player, index) =&gt; ({ ...player, rank: index + 1 }));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateTeacherUI({ analytics, leaderboard });</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- UI Update Functions ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateStudentUI(data) {</p>
<p class="p1"><span class="Apple-converted-space">             </span>const resetBtn = document.getElementById('resetDemoDataBtn');</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (resetBtn) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>if (currentUser &amp;&amp; currentUser.member_id === 'demo') {</p>
<p class="p1"><span class="Apple-converted-space">                     </span>resetBtn.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                 </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                     </span>resetBtn.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                 </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>const avatarEmoji = selectedAvatar === 'female' ? '👩‍🎓' : '👨‍🎓';</p>
<p class="p1"><span class="Apple-converted-space">             </span>const avatarClass = selectedAvatar === 'female' ? 'avatar-female' : 'avatar-male';</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>document.querySelectorAll('#playerAvatar, #dashboardAvatar').forEach(el =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>el.textContent = avatarEmoji;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>if (!el.className.includes(avatarClass)) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>el.className = el.className.replace(/avatar-(male|female)/g, '') + ` ${avatarClass}`;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>// Update texts</p>
<p class="p1"><span class="Apple-converted-space">             </span>document.getElementById('playerName').textContent = data.profile.name;</p>
<p class="p1"><span class="Apple-converted-space">             </span>document.getElementById('playerClass').textContent = data.profile.class;</p>
<p class="p1"><span class="Apple-converted-space">             </span>document.getElementById('dashboardName').textContent = data.profile.name;</p>
<p class="p1"><span class="Apple-converted-space">             </span>document.getElementById('dashboardClass').textContent = data.profile.class;</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>// Update stats</p>
<p class="p1"><span class="Apple-converted-space">             </span>['playerLevel', 'dashboardLevel'].forEach(id =&gt; document.getElementById(id).textContent = data.stats.level);</p>
<p class="p1"><span class="Apple-converted-space">             </span>['playerExp', 'dashboardExp'].forEach(id =&gt; document.getElementById(id).textContent = `${data.stats.exp}/${data.stats.exp_to_next}`);</p>
<p class="p1"><span class="Apple-converted-space">             </span>['playerCoins', 'dashboardCoins'].forEach(id =&gt; document.getElementById(id).textContent = data.stats.coins.toLocaleString());</p>
<p class="p1"><span class="Apple-converted-space">             </span>document.getElementById('completedMissions').textContent = `${data.stats.completedMissionsCount}/3`;</p>
<p class="p1"><span class="Apple-converted-space">             </span>document.getElementById('totalPlayTime').textContent = `${data.stats.totalPlayTime} นาที`;</p>
<p class="p1"><span class="Apple-converted-space">             </span>document.getElementById('accuracy').textContent = `${data.stats.accuracy}%`;</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>// Update Pre/Post Test Cards</p>
<p class="p1"><span class="Apple-converted-space">             </span>if(data.progress.preTest) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('preTestContent').innerHTML = `&lt;p class="text-gray-600 mb-2"&gt;ทำสำเร็จแล้ว&lt;/p&gt;&lt;p class="text-2xl font-bold text-blue-600"&gt;${data.progress.preTest.score}/10&lt;/p&gt;&lt;p class="text-sm text-gray-500 mt-2"&gt;กลุ่ม: ${data.stats.levelGroup}&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>if(data.progress.postTest) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('postTestContent').innerHTML = `&lt;p class="text-gray-600 mb-2"&gt;ทำสำเร็จแล้ว&lt;/p&gt;&lt;p class="text-2xl font-bold text-green-600"&gt;${data.progress.postTest.score}/10&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>// Unlock missions based on progress &amp; set time limits</p>
<p class="p1"><span class="Apple-converted-space">             </span>const timeLimits = { 'เก่ง': '1:30 นาที', 'กลาง': '2:00 นาที', 'อ่อน': '2:30 นาที' };</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>if (data.progress.preTest) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission1Btn').textContent = '🚀 เริ่มภารกิจ';</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission1Btn').disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission1Card').classList.remove('mission-locked');</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission1TimeLimit').textContent = timeLimits[data.stats.levelGroup];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (data.progress.completedMissions.includes(1)) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission2Btn').textContent = '🚀 เริ่มภารกิจ';</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission2Btn').disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission2Card').classList.remove('mission-locked');</p>
<p class="p1"><span class="Apple-converted-space">                  </span>document.getElementById('mission2TimeLimit').textContent = timeLimits[data.stats.levelGroup];</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (data.progress.completedMissions.includes(2)) {</p>
<p class="p1"><span class="Apple-converted-space">                  </span>document.getElementById('mission3Btn').textContent = '🚀 เริ่มภารกิจ';</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission3Btn').disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission3Card').classList.remove('mission-locked');</p>
<p class="p1"><span class="Apple-converted-space">                 </span>document.getElementById('mission3TimeLimit').textContent = timeLimits[data.stats.levelGroup];</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (data.progress.completedMissions.length &gt;= 3) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const postTestBtn = document.getElementById('postTestBtn');</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (postTestBtn) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>postTestBtn.textContent = '🚀 เริ่มทำแบบทดสอบ';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>postTestBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>postTestBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>postTestBtn.classList.add('bg-green-500', 'hover:bg-green-600', 'text-white');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>initializeStudentCharts(data.progress.preTest, data.progress.postTest);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateTeacherUI(data) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('teacherTotalStudents').textContent = data.analytics.length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const avgScore = data.analytics.reduce((sum, s) =&gt; sum + s.post, 0) / data.analytics.length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('teacherAvgScore').textContent = `${avgScore.toFixed(1)}/10`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate and display average DS</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalDs = data.analytics.reduce((sum, s) =&gt; sum + s.ds_value, 0);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const avgDs = data.analytics.length &gt; 0 ? totalDs / data.analytics.length : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const avgDsText = `${avgDs &gt;= 0 ? '+' : ''}${avgDs.toFixed(2)}%`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('teacherAvgDs').textContent = avgDsText;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Set Mission Completion</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('teacherMissionCompletion').textContent = '97%';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>populateLeaderboard('teacherLeaderboardContainer', data.leaderboard);</p>
<p class="p1"><span class="Apple-converted-space">            </span>populateStudentAnalytics(data.analytics);</p>
<p class="p1"><span class="Apple-converted-space">            </span>initializeTeacherCharts(data.analytics);</p>
<p class="p1"><span class="Apple-converted-space">            </span>populateClasses(MOCK_CLASSES);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Test/Quiz Functions ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function shuffleArray(array) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>for (let i = array.length - 1; i &gt; 0; i--) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const j = Math.floor(Math.random() * (i + 1));</p>
<p class="p1"><span class="Apple-converted-space">                </span>[array[i], array[j]] = [array[j], array[i]];</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>return array;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function generateTestQuestions() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const m1_q = shuffleArray(DB_QUESTIONS.filter(q =&gt; q.mission_id === 1)).slice(0, 4);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const m2_q = shuffleArray(DB_QUESTIONS.filter(q =&gt; q.mission_id === 2)).slice(0, 3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const m3_q = shuffleArray(DB_QUESTIONS.filter(q =&gt; q.mission_id === 3)).slice(0, 3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>return [...m1_q, ...m2_q, ...m3_q];</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function startTest(type) {</p>
<p class="p1"><span class="Apple-converted-space">             </span>const testHistory = type === 'pre' ? DB_PRE_TESTS : DB_POST_TESTS;</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (testHistory.some(t =&gt; t.member_id === currentUser.member_id)) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>showNotification('คุณทำแบบทดสอบนี้ไปแล้ว', 'warning');</p>
<p class="p1"><span class="Apple-converted-space">                 </span>return;</p>
<p class="p1"><span class="Apple-converted-space">             </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>currentQuiz = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: type,</p>
<p class="p1"><span class="Apple-converted-space">                </span>questions: generateTestQuestions(),</p>
<p class="p1"><span class="Apple-converted-space">                </span>answers: [],</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentQuestionIndex: 0,</p>
<p class="p1"><span class="Apple-converted-space">                </span>score: 0</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('quizTitle').textContent = type === 'pre' ? 'แบบทดสอบก่อนเรียน' : 'แบบทดสอบหลังเรียน';</p>
<p class="p1"><span class="Apple-converted-space">            </span>displayQuestion();</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('quizModal').style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function displayQuestion() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const quizContent = document.getElementById('quizContent');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const questionData = currentQuiz.questions[currentQuiz.currentQuestionIndex];</p>
<p class="p1"><span class="Apple-converted-space">            </span>const choices = shuffleArray([questionData.options[0], questionData.options[1], questionData.options[2], questionData.options[3]]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>quizContent.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-xl font-semibold mb-6"&gt;${questionData.question}&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="space-y-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>${choices.map((choice, index) =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="quiz-option border-2 border-gray-300 rounded-lg p-3" onclick="selectAnswer(this, '${choice}')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${choice}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>`).join('')}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('quizProgress').textContent = `ข้อ ${currentQuiz.currentQuestionIndex + 1} / ${currentQuiz.questions.length}`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const nextBtn = document.getElementById('nextQuestionBtn');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (currentQuiz.currentQuestionIndex === currentQuiz.questions.length - 1) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>nextBtn.textContent = 'ส่งคำตอบ';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>nextBtn.textContent = 'ข้อถัดไป';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function selectAnswer(element, answer) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.querySelectorAll('.quiz-option').forEach(el =&gt; el.classList.remove('selected'));</p>
<p class="p1"><span class="Apple-converted-space">            </span>element.classList.add('selected');</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentQuiz.answers[currentQuiz.currentQuestionIndex] = answer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function nextQuestion() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (currentQuiz.answers[currentQuiz.currentQuestionIndex] === undefined) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showNotification('กรุณาเลือกคำตอบ', 'warning');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (currentQuiz.currentQuestionIndex &lt; currentQuiz.questions.length - 1) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentQuiz.currentQuestionIndex++;</p>
<p class="p1"><span class="Apple-converted-space">                </span>displayQuestion();</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>submitTest();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function submitTest() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>let score = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>for(let i=0; i &lt; currentQuiz.questions.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if(String(currentQuiz.answers[i]) === String(currentQuiz.questions[i].options[currentQuiz.questions[i].correct])) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>score++;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentQuiz.score = score;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const db_target = currentQuiz.type === 'pre' ? DB_PRE_TESTS : DB_POST_TESTS;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const existingRecord = db_target.find(r =&gt; r.member_id == currentUser.member_id);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (existingRecord) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>existingRecord.score = score;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>db_target.push({member_id: currentUser.member_id, score: score});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>closeQuiz();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Show result modal</p>
<p class="p1"><span class="Apple-converted-space">            </span>const quizContent = document.getElementById('quizContent');</p>
<p class="p1"><span class="Apple-converted-space">            </span>quizContent.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="text-2xl font-bold mb-4"&gt;ผลการทดสอบ&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-lg mb-4"&gt;คุณได้คะแนน&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-6xl font-bold text-purple-600 mb-6"&gt;${score}&lt;span class="text-2xl text-gray-500"&gt;/10&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="confirmTestResult()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg"&gt;รับทราบผล&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('quizModal').style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('nextQuestionBtn').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function confirmTestResult() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>closeQuiz();</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('nextQuestionBtn').style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">            </span>showNotification(`ทำแบบทดสอบเสร็จแล้ว!`, 'success');</p>
<p class="p1"><span class="Apple-converted-space">            </span>loadStudentData(currentUser.member_id);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function closeQuiz() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('quizModal').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Mission Functions ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function startMission(missionId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// ... Logic to start mission ...</p>
<p class="p1"><span class="Apple-converted-space">            </span>showNotification(`เริ่มต้นภารกิจที่ ${missionId}!`, 'info');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Teacher Classroom Management ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function openCreateClassModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('createClassModal').style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function closeCreateClassModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('createClassModal').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('createClassForm').reset();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('createClassForm').addEventListener('submit', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>const newClass = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>name: document.getElementById('newClassName').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>subject: document.getElementById('newClassSubject').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>students: 0</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p1"><span class="Apple-converted-space">            </span>MOCK_CLASSES.push(newClass);</p>
<p class="p1"><span class="Apple-converted-space">            </span>populateClasses(MOCK_CLASSES);</p>
<p class="p1"><span class="Apple-converted-space">            </span>closeCreateClassModal();</p>
<p class="p1"><span class="Apple-converted-space">            </span>showNotification(`สร้างห้องเรียน "${newClass.name}" สำเร็จแล้ว`, 'success');</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function populateClasses(classes) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const container = document.getElementById('classListContainer');</p>
<p class="p1"><span class="Apple-converted-space">            </span>container.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>classes.forEach(c =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>container.innerHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-white rounded-2xl shadow p-6 card-hover flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold text-gray-800"&gt;${c.name}&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-purple-600 mb-2"&gt;${c.subject}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-grow"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex justify-between items-center mt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;span class="text-gray-500"&gt;👥 ${c.students} คน&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;button class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg font-semibold"&gt;จัดการ&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Populate dynamic content ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function populateLeaderboard(containerId, data) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const container = document.getElementById(containerId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>container.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>const rankClasses = ['leaderboard-gold', 'leaderboard-silver', 'leaderboard-bronze'];</p>
<p class="p1"><span class="Apple-converted-space">            </span>data.forEach(player =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const rankClass = player.rank &lt;= 3 ? rankClasses[player.rank - 1] : 'bg-gray-100';</p>
<p class="p1"><span class="Apple-converted-space">                </span>const rankText = player.rank &lt;= 3 ? 'text-white' : 'text-gray-800';</p>
<p class="p1"><span class="Apple-converted-space">                </span>const dsClass = player.ds_value &gt;= 0 ? (player.rank &lt;= 3 ? 'text-green-200' : 'text-green-600') : (player.rank &lt;= 3 ? 'text-red-200' : 'text-red-600');</p>
<p class="p1"><span class="Apple-converted-space">                </span>container.innerHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="flex items-center p-3 ${rankClass} rounded-lg text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="w-8 h-8 flex items-center justify-center font-bold ${rankText} rounded-full mr-3 text-base"&gt;${player.rank}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-grow ${rankText} font-semibold"&gt;${player.name}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="w-16 text-center ${rankText}"&gt;&lt;span class="text-xs opacity-80"&gt;Lv.&lt;/span&gt; ${player.level}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="w-24 text-center font-bold ${dsClass}"&gt;${player.ds}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="w-24 text-right ${rankText}"&gt;&lt;span class="font-bold"&gt;${player.exp.toLocaleString()}&lt;/span&gt; &lt;span class="text-xs opacity-80"&gt;EXP&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function populateStudentAnalytics(data) {</p>
<p class="p1"><span class="Apple-converted-space">             </span>const tableBody = document.getElementById('studentAnalyticsTable');</p>
<p class="p1"><span class="Apple-converted-space">             </span>tableBody.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">             </span>data.forEach(student =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>tableBody.innerHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;tr class="border-b hover:bg-gray-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="p-3"&gt;${student.name}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="p-3"&gt;${student.class}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="p-3"&gt;${student.level}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="p-3"&gt;${student.pre}/10&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="p-3"&gt;${student.post}/10&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="p-3 font-bold ${student.ds.startsWith('+') ? 'text-green-600' : 'text-red-600'}"&gt;${student.ds}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>`;</p>
<p class="p1"><span class="Apple-converted-space">             </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Notifications ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function showNotification(message, type = 'info') {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const container = document.getElementById('notification-container');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(!container) return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const notif = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">            </span>notif.className = `notification ${type}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>notif.textContent = message;</p>
<p class="p1"><span class="Apple-converted-space">            </span>container.appendChild(notif);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notif.classList.add('show');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}, 10);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>notif.classList.remove('show');</p>
<p class="p1"><span class="Apple-converted-space">                </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (container.contains(notif)) {</p>
<p class="p1"><span class="Apple-converted-space">                       </span>container.removeChild(notif);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, 300);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}, 3000);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Chart.js Initializers ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>let studentTestScoresChart, studentAccuracyByTopicChart, teacherStudentScoresChart;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showStudentDetailModal(memberId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const studentFullData = getStudentDataById(memberId);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const content = document.getElementById('studentDetailContent');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!studentFullData) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>content.innerHTML = '&lt;p&gt;ไม่พบข้อมูลนักเรียน&lt;/p&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('studentDetailModal').style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const { profile, stats, progress } = studentFullData;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const dsText = stats.ds ? `${stats.ds &gt;= 0 ? '+' : ''}${stats.ds.toFixed(2)}%` : 'N/A';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>content.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex items-center space-x-4 mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div class="w-16 h-16 rounded-full flex items-center justify-center text-3xl flex-shrink-0 avatar-male text-white"&gt;👨‍🎓&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-xl font-bold"&gt;${profile.name}&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-gray-500"&gt;${profile.class}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="grid grid-cols-2 gap-2 text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;Level:&lt;/strong&gt; ${stats.level}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;EXP:&lt;/strong&gt; ${stats.exp}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;Pre-Test:&lt;/strong&gt; ${progress.preTest ? progress.preTest.score : 'N/A'}/10&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p&gt;&lt;strong&gt;Post-Test:&lt;/strong&gt; ${progress.postTest ? progress.postTest.score : 'N/A'}/10&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="col-span-2"&gt;&lt;strong&gt;คะแนนพัฒนาการ (DS):&lt;/strong&gt; &lt;span class="font-bold ${stats.ds &lt; 0 ? 'text-red-600' : 'text-green-600'}"&gt;${dsText}&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="col-span-2"&gt;&lt;strong&gt;ภารกิจที่สำเร็จ:&lt;/strong&gt; ${progress.completedMissions.length}/3&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('studentDetailModal').style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function closeStudentDetailModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('studentDetailModal').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function initializeStudentCharts(preTest, postTest) {</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (studentTestScoresChart) studentTestScoresChart.destroy();</p>
<p class="p1"><span class="Apple-converted-space">             </span>studentTestScoresChart = new Chart(document.getElementById('studentTestScoresChart'), {</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: 'bar',</p>
<p class="p1"><span class="Apple-converted-space">                </span>data: {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>labels: ['Pre-test', 'Post-test'],</p>
<p class="p1"><span class="Apple-converted-space">                    </span>datasets: [{ label: 'คะแนน', data: [preTest?.score || 0, postTest?.score || 0], backgroundColor: ['#60a5fa', '#10b981'] }]</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>options: { scales: { y: { beginAtZero: true, max: 10 } } }</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">             </span>if (studentAccuracyByTopicChart) studentAccuracyByTopicChart.destroy();</p>
<p class="p1"><span class="Apple-converted-space">             </span>studentAccuracyByTopicChart = new Chart(document.getElementById('studentAccuracyByTopicChart'), {</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: 'radar',</p>
<p class="p1"><span class="Apple-converted-space">                </span>data: {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>labels: ['นิยาม', 'สมบัติ', 'สัญกรณ์'],</p>
<p class="p1"><span class="Apple-converted-space">                    </span>datasets: [{ label: 'ความแม่นยำ', data: [0, 0, 0], fill: true, backgroundColor: 'rgba(167, 139, 250, 0.2)', borderColor: '#8b5cf6', pointBackgroundColor: '#8b5cf6' }]</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                 </span>options: { elements: { line: { borderWidth: 3 } }, scales: { r: { beginAtZero: true, max: 100 } } }</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">         </span>function initializeTeacherCharts(analyticsData) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const passedCount = analyticsData.filter(s =&gt; s.post &gt;= 5).length;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const failedCount = analyticsData.length - passedCount;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (teacherStudentScoresChart) teacherStudentScoresChart.destroy();</p>
<p class="p1"><span class="Apple-converted-space">            </span>teacherStudentScoresChart = new Chart(document.getElementById('teacherStudentScoresChart'), {</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: 'doughnut',</p>
<p class="p1"><span class="Apple-converted-space">                </span>data: {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>labels: ['ผ่าน (มากกว่า 50%)', 'ไม่ผ่าน'],</p>
<p class="p1"><span class="Apple-converted-space">                    </span>datasets: [{</p>
<p class="p1"><span class="Apple-converted-space">                        </span>label: 'จำนวนนักเรียน',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>data: [passedCount, failedCount],</p>
<p class="p1"><span class="Apple-converted-space">                        </span>backgroundColor: ['#10b981', '#ef4444']</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}]</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const helpList = document.getElementById('studentsToHelpList');</p>
<p class="p1"><span class="Apple-converted-space">            </span>helpList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>const studentsToHelp = analyticsData.filter(s =&gt; s.ds_value &lt; 0);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (studentsToHelp.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>studentsToHelp.forEach(s =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>helpList.innerHTML += `&lt;li onclick="showStudentDetailModal(${s.member_id})" class="p-3 bg-red-100 rounded-lg text-red-800 cursor-pointer hover:bg-red-200 transition-colors flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span&gt;${s.name}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span class="font-bold"&gt;${s.ds}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/li&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>helpList.innerHTML = `&lt;li class="p-3 bg-green-100 rounded-lg text-green-800"&gt;ไม่มีนักเรียนที่ต้องการความช่วยเหลือพิเศษในขณะนี้ ยอดเยี่ยม!&lt;/li&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Gemini API Function ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function getAIHint() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const hintContainer = document.getElementById('aiHintContainer');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const hintText = document.getElementById('aiHintText');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const hintButton = document.getElementById('aiHintButton');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>hintContainer.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">            </span>hintText.textContent = 'กำลังขอคำใบ้จาก AI...';</p>
<p class="p1"><span class="Apple-converted-space">            </span>hintButton.disabled = true;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const questionData = currentQuiz.questions[currentQuiz.currentQuestionIndex];</p>
<p class="p1"><span class="Apple-converted-space">            </span>const incorrectAnswer = currentQuiz.answers[currentQuiz.currentQuestionIndex];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const systemPrompt = "You are a helpful math tutor for a middle school student. Your role is to provide a short, simple hint in Thai to guide them to the correct thinking process without giving away the direct answer or the final calculation.";</p>
<p class="p1"><span class="Apple-converted-space">            </span>const userQuery = `นักเรียนกำลังทำโจทย์คณิตศาสตร์เรื่องเลขยกกำลัง โจทย์คือ: "${questionData.question}" เขาตอบผิดโดยเลือกคำตอบ "${incorrectAnswer}" คำตอบที่ถูกต้องคือ "${questionData.answer}" กรุณาให้คำใบ้สั้นๆ เป็นภาษาไทย เพื่อชี้แนะแนวทางที่ถูกต้อง โดยไม่ต้องเฉลยคำตอบโดยตรง`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const payload = {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>contents: [{ parts: [{ text: userQuery }] }],</p>
<p class="p1"><span class="Apple-converted-space">                    </span>systemInstruction: {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>parts: [{ text: systemPrompt }]</p>
<p class="p1"><span class="Apple-converted-space">                    </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const response = await fetch(API_URL, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>headers: { 'Content-Type': 'application/json' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>body: JSON.stringify(payload)</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!response.ok) {</p>
<p class="p1"><span class="Apple-converted-space">                   </span>throw new Error(`API request failed with status ${response.status}`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const result = await response.json();</p>
<p class="p1"><span class="Apple-converted-space">                </span>const candidate = result.candidates?.[0];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (candidate &amp;&amp; candidate.content?.parts?.[0]?.text) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>hintText.textContent = candidate.content.parts[0].text;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>hintText.textContent = 'ขออภัย, ไม่สามารถสร้างคำใบ้ได้ในขณะนี้';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Gemini API Error:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>hintText.textContent = 'เกิดข้อผิดพลาดในการเชื่อมต่อกับ AI';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">                </span>hintButton.style.display = 'none'; // Hide button after use</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- Initial State ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>showScreen('loginScreen');</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
<p class="p2"><br></p>
</body>
</html>
